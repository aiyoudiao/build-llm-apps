#  day5-1

## 一、RAG技术与应用

### 1.目标

- 大模型应用开发的三种模式

	- 提示工程

		- 适用场景：问题表述不清时使用
		- 实施方法：优化提示词表达
		- 特点：零开发成本，直接用大模型接口

	- RAG（检索增强生成）

		- 核心作用：解决模型缺乏背景知识
		- 技术原理：检索外部知识库补充上下文
		- 典型应用：企业知识问答、智能客服（主要内用）
		- 优势：成本低，能满足90%以上企业需求

	- 微调

		- 适用条件：模型能力不足时
		- 成本分析：

			- 数据量：90万条
			- 训练时间：每轮32小时，需4-6轮
			- 模型规模：通常3B参数

		- 落地现状：工业应用不足5%，多用于系统学习

- 选择策略

	- 决策流程：提示工程→RAG→微调
	- 经济性考虑：微调成本包括数据清洗与训练
	- 实践建议：优先考虑RAG，平衡效果与成本

### 2. RAG技术详解

- 基本概念

	- 全称：Retrieval-Augmented Generation
	- 组成：信息检索结合文本生成
	- 工作流程：

		- 1. 实时检索相关文档
		- 2. 作为上下文输入
		- 3. 生成最终答案

- 核心优势

	- 知识时效性：突破数据时间限制
	- 幻觉控制：参考来源降低虚假生成
	- 专业深度：结合行业知识库
	- 引用机制：标注参考文献

- 技术必要性

	- 上下文限制：企业知识库远超1M字符
	- 知识密度：大模型泛知识难满足专业需求
	- 实际案例：特朗普关税政策

- 实施要点

	- 数据准备：建立结构化知识库
	- 检索优化：设计高效匹配策略
	- 结果验证：实现答案溯源

### 3. RAG的核心原理与流程

- 数据预处理

	- 知识库构建：多源数据收集，切分为块（300-1000字）
	- 数据治理：持续管理，优先处理核心数据
	- 文档分块：保持语义完整，控制在500字左右

- 嵌入与向量化

	- 向量概念：多维特征表达
	- 处理流程：文本分块→模型嵌入→存入向量数据库
	- 模型选择：BGE、M3E、Chinese-Alpaca-2等

- 向量化模型应用

	- 优势：预训练免训练
	- 性能参考：Hugging Face排行榜
	- 建议：直接用现成模型

- 检索的筛选与重排序

	- 两阶段筛选：

		- 1. 初筛：相似度最高的100个
		- 2. 精排：排序后选10个

	- 效率：成本低于直接筛选
	- 类比：HR筛简历

- 检索阶段

	- 查询处理：问题转向量
	- 相似匹配：在向量库中找相似度最高
	- 重排序：匹配相关性排序

- 生成阶段

	- 上下文组装：整合关键信息
	- 答案生成：模型基于上下文输出
	- 价值：决定回答质量

- RAG流程总结

	- 索引：文档切块→存储向量
	- 检索：问题向量匹配
	- 生成：合成回答

- 典型案例

	- 回答评估：无RAG模型无法分析事件，RAG能结合检索内容给出深入分析
	- 参数建议：细节块300-500字，优先Top K策略

### 4. Embedding模型选择

- 中文模型

	- BGE-M3：多语言支持，长文检索
	- M3E-Base：中文优化，私有部署
	- stella-mrl-large-zh-v3.5：中文高阶语义
	- Jina-embeddings-v2-small：轻量快，适边缘设备

- 多语言模型

	- OpenAI：text-embedding-3-large（维度3072）
	- 其他：支持超长文本、不同场景

- Embedding与大模型区别

	- Embedding模型：知识向量化，用于检索
	- 大模型：问答，直接回答
	- 指标不同：向量维度、任务功能

- 中文嵌入模型

	- BGE-M3：支持多语，长文
	- M3E-Base：中文优化
	- stella：细腻语义
	- Jina：小参数，实时

### 5. 指令驱动与复杂任务模型

- gte-Qwen2-7B-instruct：支持多模态、多任务、指令理解
- E5-mistral-7B：高性能，动态调整

### 6. 企业级与复杂系统

- BGE-M3企业优势

	- 部署：中等模型规模，支持多语言
	- 资源：1-2G GPU

- gte模型

	- 性能：擅长指令理解
	- 应用：复杂任务处理

- 典型应用

	- 模型初始化：模型下载，参数设置
	- 向量编码：文本、图像
	- 相似度计算：矩阵乘
	- 检索优化：多重筛选
	- 答案合成：整合回答

### 7. 典型企业应用场景

- 迪士尼客服：门票规则，活动海报
- 多模态知识库：文本+图像
- 政府企业知识问答：合同、条例
- 金融医疗：报告解读，法规遵从

## 二、RAG系统案例与实践

### 1. 搭建知识检索系统

- 开发工具

	- 架构：RAG结合Faiss、阿里云模型、DeepSeek-V3
	- 框架：LangChain封装调用
	- API 配置：密钥存放环境变量

- 文档处理

	- PDF/Word文本提取
	- 页面页码提取
	- 文本切分（最大1000字符，重叠200字符）

- 向量化与存储

	- 使用API生成1024维向量
	- 建立Faiss索引
	- 保存本地数据库文件

- 检索与回答

	- 用户问题转向量
	- 在向量库中找最相关的块
	- 组合检索内容与大模型生成答案

### 2. 具体案例

- 客户投诉扣分

	- 过程：文本匹配到相关内容后，结合规则提供答案

- 申报时间查询

	- 自动匹配相关条例，给出具体时间

- 银行问答

	- 多模态内容：PDF内容和图片识别
	- 切片策略：规则化/语义化

- 视技术细节优化

	- 文档切割：自然边界、语义完整
	- 图像OCR：PaddleOCR优质
	- 关键词触发：如&quot;海报&quot;调出图片检索

- 多模态检索示范

	- 文本与图片联合检索
	- 关键词控制触发
	- 计算相似度、合成答案

### 3. 性能与应用建议

- 构建多模态知识库
- 使用本地部署保障敏感数据
- 结合向量检索与关键词
- 设置多阶段筛选提升准确率

## 三、总结与学习建议

### 认知策略

- 框架优先：理解整体流程
- 问题驱动：结合具体任务学习
- 工具协作：善用AI工具

### 执行建议

- 使用示例快速入门
- 逐步调试，验证效果
- 迭代优化模型选择

## 四、知识点总结

### RAG技术要点

- 检索增强：结合信息检索和生成
- 三阶段流程：检索、增强、生成
- 关键组件：向量数据库、嵌入模型、大模型
- 结构流程：文档准备→索引→检索→合成答案

### 应用场景

- 企业知识管理
- 智能客服
-专业领域咨询
-多模态信息处理

### 技术选型

- 长文检索模型：BGE-M3、M3E-Base
- 多模态模型：CLIP、TextEmbedding
- 策略：多路检索、关键词触发

### 实践建议

- 优先RAG方案
- 结合微调增强
- 综合多模态信息提升效果
- 本地部署保障安全

