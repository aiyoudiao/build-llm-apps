# day5-2

## 1.知识点总结

- 关键技术：检索增强、改写、图谱
- 方法策略：多通路、双向、混合
- 实践应用：企业、学术、金融
- 评估指标：准确率、响应时间、成本
- 工具平台：LangChain、FAISS、Graphrag等
- 未来趋势：持续优化、成本控制、多模态结合

## 2. 文件格式选择

### 格式选择原则

- 内容解析程度优先于格式本身

### 转换建议

- PDF/PPT建议转换为markdown格式
- 支持代码块、表格、图像嵌入，布局更完整

### 纯文本局限

- txt仅适合无格式要求的内容

## 3. 学习建议

### 学习方法论

- 聚焦原则：深入掌握当前课程内容
- 问题处理：利用AI工具（如DeepSeek）辅助理解
- 代码实践：重在逻辑理解与结果验证，避免盲目敲代码

### AI编程趋势

- 行业实践：国外普遍要求AI辅助编程
- 关键能力：逻辑思维比语法记忆更重要
- 重要环节：人工Code检查和逻辑梳理

## 4. 技术问答

### 开发框架选择

- 常见：LangChain、Graph、千帆Agent
- 选择依据：需求功能

### 模型部署趋势

- 大模型（DeepSeek全量版）与嵌入式小模型（1.5B/0.6B）
- 移动端：本地化模型成为重要应用场景

### 知识库应用

- 办公集成：API集成到办公软件
- 功能扩展：写作指导、提醒等

## 5. RAG技术核心

- 关键技能：大模型应用开发的核心
- 提高准确率：方法讲解
- 实践案例：DeepSeek+Faiss本地知识库搭建示例

## 6. RAG流程回顾

### 核心环节

- 知识库处理
- 检索优化
- 生成策略

### 关键技术

- Query改写
- 智能识别
- 联网搜索

### 向量数据库

- 处理流程：

  - Indexing：文档分块转向量
  - Retrieval：计算相似度，Top K
  - Generation：拼接检索结果与问题生成答案
- 技术要点：

  - 向量维度：由embedding模型决定
  - 相似度：cos值排序
  - 框架：LangChain封装QA链+FAISS等

## 7. 召回策略

### 召回数量设置

- 参数k含义：召回片段数
- 建议值：4-5个，扩展至10或30，常用范围5-10
- 注意：k过大需重排序，否则影响质量

### 知识图谱应用

- 区别：实体和关系连接片段
- 应用：申论知识点关联、生物概念网络
- 实例：姚明女儿身高（实体关系链）

### 重排序模型

- BGE-Rerank模型

  - 原理：监督学习序列分类
  - 评分：高相关（4.95+），中等，负值不相关
  - 版本：支持本地部署，模型文件2-3GB
- Cohere Rerank模型

  - 特色：商业API，输出0-1标准化分
  - 对比：召回模型快，重排模型精细

### 查询优化

- Query改写

  - 目的：提升检索质量
  - 方法：Prompt引导，改写口语化或模糊查询
  - 类型：

    - 上下文依赖：补上下文
    - 对比：明确比较对象
    - 模糊指代：具体化代词
    - 多意图：拆分复杂问题，用JSON输出
    - 反问：转为中立陈述
- 意图识别

  - 方法：多任务Prompt判定
  - 输出：JSON结构（查询类型、改写内容、置信度）
  - 评分：模型给出的感性评分（0.8-0.95）

### 查询优化实践

- 转写技巧：识别意图、明确对象、时间标注
- 提升检索：改写后直接用于向量检索
- 实现平台：LangChain、LlamaIndex等，持续优化

## 8. 联网检索场景

### 典型场景

- 时效信息：天气、新闻、实时状态
- 价格信息：门票、商品价格
- 活动信息：演出、促销
- 实时状态：人流、交通
- 空间信息：交通路线、地理位置

### 搜索改写功能

- 判断：identify_web_search_needs(query, conversation)
- 输出：需联网（布尔）、理由、信心

### 具体应用

- 时间敏感：查询实时开放和状态
- 价格敏感：需实时价格
- 活动：动态事务
- 搜索策略：关键词、平台、时间范围（用JSON规范）

### 工具支持

- 调用：Tavily等引擎
- 参数：关键词、平台、时间段

## 9. 双向改写

### Query2Doc

- 目标：扩展用户短查询，缓解向量化差异
- 方法：多维度扩展，生成中间文档
- 使用场景：短查询信息不足时
- 注意：成本较高，结果非答案，仅供检索

### Doc2Query

- 目标：为文档生成潜在问题
- 方法：预测用户可能提问
- 优势：提高检索命中

### 实践流程

- 定义指令模板
- 提供示例
- 执行改写：如&quot;中国有哪些滑雪胜地&quot;
- 融合应用：用于知识库检索
- 设计要点：角色设定、示例、效果验证
- 依赖合作：知识检索、答案生成模块配合
- 成本考虑：确保效率、效果

## 10. 索引扩展

### 离散索引

- 技术：关键词抽取、实体识别
- 例子：BM25等TF-IDF改进

### 连续索引

- 多模型结合：OpenAI Ada、智源BGE等
- 特点：多路召回

### 混合索引

- 组合：离散+向量索引
- 应用：精确场景优先，融合多策略

### Small-to-Big策略

- 小规模：摘要、关键句
- 大规模：全文或链接
- 机制：二阶段匹配，增强答案连贯性

### 知识库处理

- 生成问题：利用AI扩展知识
- 特征工程：预处理优化
- 数据预处理：分片、生成、评估

### 问题生成

- 样式多样：问、对比、推理、条件
- 分类：JSON记录，确保质量

### 检索优化

- BM25等关键词
- 多路召回与重排结合

### 知识图谱

- 构建实体关系图
- 聚类、社区分析
- 工具：Microsoft Graphrag
- 应用：社区层级、结构丰富回答

### GraphRAG

- 结合图谱信息
- 结构化索引
- 应用：金融、百科、历史
- 生成流程：实体提取、关系提取、索引构建
- 案例：三国演义实体关系

### 查询模式

- 全局：宏观战略
- 本地：具体章节

### 成本与效果

- 预处理约30分钟/百元
- 查询：每次几美元
- 提升：回答质量、准确率
